<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Biofilter Udara Berbasis Ampas Tebu</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/@phosphor-icons/web"></script>

<style>
body{
  background: radial-gradient(circle at top, #0b1220, #020617);
}
.glass{
  backdrop-filter: blur(16px);
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.1);
}
.bar{
  transition: width 1.4s ease, background-color 1.4s ease;
}
</style>
</head>

<body class="text-slate-200 min-h-screen tracking-tight">

<!-- K3 POPUP -->
<div id="k3Popup" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50">
  <div class="glass rounded-2xl p-6 max-w-md text-center">
    <i class="ph ph-shield-warning text-4xl text-red-400"></i>
    <h2 class="text-lg font-semibold mt-3">Safety & K3 Notice</h2>
    <p class="text-sm opacity-70 mt-2">
      This system monitors ambient air quality and biofilter performance.
      Hazardous pollutant levels may pose serious health and environmental risks.
    </p>
    <button onclick="closeK3()"
      class="mt-5 px-6 py-2 rounded-xl bg-emerald-500 text-black font-medium">
      Acknowledge & Proceed
    </button>
  </div>
</div>

<!-- INFO POPUP -->
<div id="infoPopup" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-40">
  <div class="glass rounded-2xl p-6 max-w-2xl w-full mx-4 space-y-4 overflow-y-auto max-h-[85vh]">
    <h2 class="text-lg font-semibold flex items-center gap-2">
      <i class="ph ph-info"></i> Research & System Information
    </h2>

    <div class="space-y-2 text-sm">
      <p><b>What is Smart Biofilter?</b><br>
      An IoT-based air filtration monitoring system utilizing sugarcane bagasse
      as a sustainable biofilter medium to reduce particulate and gaseous pollutants.</p>

      <p><b>Estimated Filtration Efficiency</b><br>
      PM Reduction: <span class="text-emerald-400">â‰ˆ 62%</span><br>
      Gaseous Pollutant Reduction: <span class="text-emerald-400">â‰ˆ 48%</span></p>

      <p><b>Before vs After Filtration</b><br>
      Before: High particulate and gas concentration<br>
      After: Reduced pollutant index through adsorption and biofiltration</p>

      <p><b>Scientific Basis</b><br>
      Sugarcane bagasse contains porous lignocellulosic fibers which enable
      particulate trapping and adsorption of gaseous pollutants.</p>

      <p><b>Automatic Control Logic</b><br>
      Fan speed is automatically increased when pollutant levels exceed
      moderate health thresholds to enhance filtration efficiency.</p>

      <p><b>System Limitation</b><br>
      â€¢ Sensor drift without calibration<br>
      â€¢ Environmental conditions affect adsorption performance<br>
      â€¢ Not a replacement for certified monitoring instruments</p>

      <p class="opacity-60">
        Health classification follows WHO Air Quality Guidelines (2021).
      </p>
    </div>

    <button onclick="closeInfo()"
      class="mt-4 px-5 py-2 rounded-xl bg-cyan-400 text-black">
      Close Information
    </button>
  </div>
</div>

<!-- HEADER -->
<header class="px-6 py-4 flex justify-between items-center border-b border-white/10">
  <div>
    <h1 class="text-lg font-semibold">Smart Biofilter Air System</h1>
    <p class="text-xs opacity-60">
      Sugarcane Bagasseâ€“Based Air Filtration | IoT Monitoring
    </p>
  </div>

  <div class="flex items-center gap-4">
    <span class="text-sm opacity-70">SMK-SMTI YOGYAKARTA</span>

    <button onclick="openInfo()"
      class="glass w-9 h-9 rounded-full flex items-center justify-center">
      <i class="ph ph-info"></i>
    </button>
  </div>
</header>

<!-- VIEW SELECTOR -->
<div class="px-6 mt-4 flex gap-2">
  <button onclick="setView(1)" class="glass px-3 py-2 rounded-xl"><i class="ph ph-grid-four"></i></button>
  <button onclick="setView(2)" class="glass px-3 py-2 rounded-xl"><i class="ph ph-chart-bar"></i></button>
  <button onclick="setView(3)" class="glass px-3 py-2 rounded-xl"><i class="ph ph-lightbulb"></i></button>
  <button onclick="setView(4)" class="glass px-3 py-2 rounded-xl"><i class="ph ph-fan"></i></button>
</div>

<!-- VIEW 1 -->
<section id="view1" class="px-6 mt-6 space-y-6">
  <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
    <div class="glass rounded-2xl p-4"><p class="text-xs opacity-60">System Time</p><p id="clock" class="text-lg"></p></div>
    <div class="glass rounded-2xl p-4"><p class="text-xs opacity-60">ESP32 Status</p><p class="text-lg text-emerald-400">Online</p></div>
    <div class="glass rounded-2xl p-4"><p class="text-xs opacity-60">Battery Level</p><p id="battery" class="text-lg">89%</p></div>
    <div class="glass rounded-2xl p-4"><p class="text-xs opacity-60">Internal Temperature</p><p id="temp" class="text-lg">24.6Â°C</p></div>
    <div class="glass rounded-2xl p-4"><p class="text-xs opacity-60">System Voltage</p><p id="voltage" class="text-lg">4.7 V</p></div>
    <div class="glass rounded-2xl p-4"><p class="text-xs opacity-60">Filter Lifetime</p><p id="filterAge" class="text-lg text-cyan-400">0 Days</p></div>
  </div>

  <div class="glass rounded-2xl p-4">
    <div class="flex justify-between mb-2">
      <span class="text-sm">Safety & Hazard Log</span>
      <button onclick="clearLog()" class="text-xs bg-emerald-500 text-black px-3 py-1 rounded-lg">
        Maintenance Done
      </button>
    </div>
    <div id="logs" class="space-y-2 max-h-56 overflow-auto text-sm"></div>
  </div>
</section>

<!-- VIEW 2 -->
<section id="view2" class="hidden px-6 mt-6 space-y-6">
  <div class="glass rounded-2xl p-4">
    <canvas id="airChart" height="120"></canvas>
  </div>
  <div class="glass rounded-2xl p-4">
    <div id="sensorList" class="space-y-4"></div>
  </div>
</section>

<!-- VIEW 3 -->
<section id="view3" class="hidden px-6 mt-6">
  <div class="glass rounded-2xl p-4">
    <div id="recommendation" class="space-y-3 text-sm"></div>
  </div>
</section>

<!-- VIEW 4 -->
<section id="view4" class="hidden px-6 mt-6">
  <div class="glass rounded-2xl p-4 space-y-4">
    <div class="flex justify-between">
      <span>Fan Control Mode</span>
      <button id="modeBtn" onclick="toggleMode()"
        class="px-4 py-2 rounded-xl bg-cyan-400 text-black">
        AUTO
      </button>
    </div>
    <div class="flex justify-between">
      <span>Fan Status</span>
      <span id="fanStatus" class="text-emerald-400">Normal</span>
    </div>
  </div>
</section>

<script>
function closeK3(){k3Popup.classList.add("hidden")}
function openInfo(){infoPopup.classList.remove("hidden")}
function closeInfo(){infoPopup.classList.add("hidden")}

function setView(v){
  [view1,view2,view3,view4].forEach((el,i)=>{
    el.classList.toggle("hidden",i+1!==v)
  })
}

setInterval(()=>{
  clock.textContent=new Date().toLocaleTimeString()
},1000)

const sensors=["PM10 & PM2.5","SOâ‚‚","CO","Oâ‚ƒ","NOâ‚‚","HC"]
let values=sensors.map(()=>Math.floor(30+Math.random()*20))

function color(v){
  if(v<=50)return"#22c55e"
  if(v<=100)return"#3b82f6"
  if(v<=200)return"#facc15"
  return"#ef4444"
}

function status(v){
  if(v<=50)return"Good"
  if(v<=100)return"Moderate"
  if(v<=200)return"Unhealthy"
  return"Hazardous"
}

const chart=new Chart(airChart,{
  type:"bar",
  data:{labels:sensors,datasets:[{data:values,backgroundColor:values.map(color)}]},
  options:{animation:false,scales:{y:{min:0,max:350}}}
})

let autoMode=true
function toggleMode(){
  autoMode=!autoMode
  modeBtn.textContent=autoMode?"AUTO":"MANUAL"
  modeBtn.className=autoMode
    ?"px-4 py-2 rounded-xl bg-cyan-400 text-black"
    :"px-4 py-2 rounded-xl bg-yellow-400 text-black"
}

function render(){
  sensorList.innerHTML=""
  recommendation.innerHTML=""
  sensors.forEach((s,i)=>{
    sensorList.innerHTML+=`
      <div>
        <div class="flex justify-between text-xs mb-1">
          <span>${s}</span>
          <span>${values[i]} (${status(values[i])})</span>
        </div>
        <div class="h-2 bg-white/10 rounded-full">
          <div class="h-2 rounded-full bar"
            style="width:${Math.min(values[i],300)/3}%;background:${color(values[i])}">
          </div>
        </div>
      </div>`
    const advice={
      "PM10 & PM2.5":"Increase airflow residence time and inspect filter density.",
      "SOâ‚‚":"Maintain biofilter moisture for gas adsorption.",
      "CO":"Inspect nearby combustion sources immediately.",
      "Oâ‚ƒ":"Reduce airflow velocity and UV exposure.",
      "NOâ‚‚":"Inspect industrial emission proximity.",
      "HC":"Replace saturated biofilter media."
    }
    recommendation.innerHTML+=`
      <div class="glass rounded-xl p-3">
        <b>${s}</b><br>
        ${values[i]>200?advice[s]:"Conditions stable. Continue monitoring."}
      </div>`
  })
}

function addLog(m){
  logs.innerHTML=`<div class="glass rounded-xl p-2 text-red-400">${m}</div>`+logs.innerHTML
}

function clearLog(){
  logs.innerHTML=`<div class="text-emerald-400">Maintenance action recorded</div>`
}

render()
let filterDay=1

setInterval(()=>{
  values=values.map(()=>Math.floor(Math.random()*350))
  chart.data.datasets[0].data=values
  chart.data.datasets[0].backgroundColor=values.map(color)
  chart.update()
  render()

  values.forEach((v,i)=>{
    if(v>200)addLog(`${sensors[i]} detected ${status(v)} level`)
  })

  battery.textContent=Math.floor(70+Math.random()*30)+"%"
  temp.textContent=(34+Math.random()*4).toFixed(1)+"Â°C"
  voltage.textContent=(4.2+Math.random()*0.3).toFixed(2)+"V"
  filterAge.textContent=filterDay+" Days"
  fanStatus.textContent=autoMode?(values.some(v=>v>150)?"High Speed":"Normal"):"Manual Control"
  filterDay++
},30000) <!-- setiap 5 menit sekali -->
</script>
<!-- Kode ini terakhir dibuat pada pukul 10.14 pada perangkat OPPO A18 -->
<!-- ANTI AI ðŸ¤ª -->
</body>
</html>
